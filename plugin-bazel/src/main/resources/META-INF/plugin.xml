<idea-plugin require-restart="false" package="org.jetbrains.bazel">
    <id>org.jetbrains.bazel</id>
    <name>Bazel by JetBrains (experimental)</name>
    <vendor>JetBrains</vendor>
    <dependencies>
        <module name="intellij.bsp.main"/>
        <plugin id="com.intellij.modules.platform"/>
    </dependencies>
    <extensions defaultExtensionNs="com.intellij">
        <bspProjectOpenProcessorExtension
                implementation="org.jetbrains.bazel.flow.open.BazelBspProjectOpenProcessorExtension"/>

        <projectOpenProcessor
                implementation="org.jetbrains.bazel.flow.open.BazelBspProjectOpenProcessor"/>

        <buildToolAssetsExtension
                implementation="org.jetbrains.bazel.assets.BazelAssetsExtension"/>

        <bspConnectionDetailsGeneratorExtension
                implementation="org.jetbrains.bazel.flow.open.BazelBspDetailsConnectionGenerator"/>
        <bspBuildTargetClassifierExtension
                implementation="org.jetbrains.bazel.extension.BazelBuildTargetClassifier"/>
        <bspProjectAwareExtension implementation="org.jetbrains.bazel.config.BazelBspProjectAwareExtension"/>
        <externalSystemUnlinkedProjectAware
                id="Bazel BSP"
                implementation="org.jetbrains.bazel.flow.open.BazelBspUnlinkedProjectAware"/>
        <externalIconProvider key="bazelbsp" implementationClass="org.jetbrains.bazel.config.BazelExternalSystemIconProvider"/>

        <!--        <bspConnectionDetailsGeneratorExtension-->
        <!--                implementation="org.jetbrains.bazel.extension.BazelBspConnectionDetailsGenerator"-->
        <!--        />-->
        <fileType
                name="Starlark"
                implementationClass="org.jetbrains.bazel.languages.starlark.StarlarkFileType"
                fieldName="INSTANCE"
                language="Starlark"
                fileNames="BUILD;WORKSPACE"
                extensions="bzl;bazel;bzlmod"/>

        <lang.parserDefinition
                language="Starlark"
                implementationClass="org.jetbrains.bazel.languages.starlark.parser.StarlarkParserDefinition"/>
        <lang.syntaxHighlighterFactory
                language="Starlark"
                implementationClass="org.jetbrains.bazel.languages.starlark.highlighting.StarlarkSyntaxHighlighterFactory"/>
        <lang.commenter
                language="Starlark"
                implementationClass="org.jetbrains.bazel.languages.starlark.commenter.StarlarkCommenter"/>
        <lang.braceMatcher
                language="Starlark"
                implementationClass="org.jetbrains.bazel.languages.starlark.matching.StarlarkBraceMatcher"/>
        <lang.quoteHandler
                language="Starlark"
                implementationClass="org.jetbrains.bazel.languages.starlark.matching.StarlarkQuoteHandler"/>
        <colorSettingsPage
                implementation="org.jetbrains.bazel.languages.starlark.highlighting.StarlarkColorSettingsPage"/>
        <additionalTextAttributes
                scheme="Default"
                file="colorSchemes/StarlarkDefault.xml"/>
        <additionalTextAttributes
                scheme="Darcula"
                file="colorSchemes/StarlarkDarcula.xml"/>
        <annotator
                language="Starlark"
                implementationClass="org.jetbrains.bazel.languages.starlark.annotation.StarlarkFunctionAnnotator"/>
        <annotator
                language="Starlark"
                implementationClass="org.jetbrains.bazel.languages.starlark.annotation.StarlarkStringAnnotator"/>
    </extensions>

    <actions>
        <action class="org.jetbrains.bazel.flow.open.OpenBazelProjectViaBspPluginAction"
                icon="/icons/bazel.svg">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
        </action>

    </actions>
</idea-plugin>
